// Code generated by qtc from "CellView.qtpl". DO NOT EDIT.
// See https://github.com/valyala/quicktemplate for details.

//line app/qtpl/CellView.qtpl:1
package qtpl

//line app/qtpl/CellView.qtpl:1
import (
	"bytes"
	"github.com/kere/blackfriday"
	"github.com/kere/gno/db"
	"github.com/kere/gno/libs/util"
	"onqee.visualstudio.com/D2O/app/model"
	"onqee.visualstudio.com/D2O/app/model/baseinfo"
	"onqee.visualstudio.com/D2O/app/model/selem"
)

// dateON := row.String(model.FieldDateON)

//line app/qtpl/CellView.qtpl:12
import (
	qtio422016 "io"

	qt422016 "github.com/valyala/quicktemplate"
)

//line app/qtpl/CellView.qtpl:12
var (
	_ = qtio422016.Copy
	_ = qt422016.AcquireByteBuffer
)

//line app/qtpl/CellView.qtpl:12
func StreamCellView(qw422016 *qt422016.Writer, row db.MapRow, ojson *selem.OJSON) {
//line app/qtpl/CellView.qtpl:12
	qw422016.N().S(`
`)
//line app/qtpl/CellView.qtpl:14
	iid := row.Int(model.FieldIID)
	nick := row.String(model.FieldNick)
	dateAt := row.String(model.FieldUpdatedAt)
	tags := row.Strings("tags")
	content := ojson.Contents[0]
	areas := ojson.Area
	subforms := ojson.SubForms

//line app/qtpl/CellView.qtpl:21
	qw422016.N().S(`
<div class="gno-cell-view container clearfix">
  <div class="header m-b-md">
    <h1><a href="/cell/view/`)
//line app/qtpl/CellView.qtpl:24
	qw422016.N().D(iid)
//line app/qtpl/CellView.qtpl:24
	qw422016.N().S(`">`)
//line app/qtpl/CellView.qtpl:24
	qw422016.E().S(content.Title)
//line app/qtpl/CellView.qtpl:24
	qw422016.N().S(`</a></h1>
  </div>
  <div class="content">
    `)
//line app/qtpl/CellView.qtpl:28
	unsafe := blackfriday.Run(util.Str2Bytes(content.Text))
	src := policy.SanitizeBytes(unsafe)

//line app/qtpl/CellView.qtpl:29
	qw422016.N().S(`
    `)
//line app/qtpl/CellView.qtpl:30
	qw422016.N().Z(src)
//line app/qtpl/CellView.qtpl:30
	qw422016.N().S(`
  </div>
	<hr class="dashed"></hr>
	`)
//line app/qtpl/CellView.qtpl:33
	qw422016.N().S(AreasTags(areas, tags))
//line app/qtpl/CellView.qtpl:33
	qw422016.N().S(`

	`)
//line app/qtpl/CellView.qtpl:35
	qw422016.N().S(Subforms(subforms))
//line app/qtpl/CellView.qtpl:35
	qw422016.N().S(`
  <footer class="article-footer">
    `)
//line app/qtpl/CellView.qtpl:38
	bDateAt := util.Str2Bytes(dateAt)
	if len(dateAt) > 10 {
		bDateAt = bDateAt[:10]
	}

//line app/qtpl/CellView.qtpl:41
	qw422016.N().S(`
    <p class="date_on">`)
//line app/qtpl/CellView.qtpl:42
	qw422016.E().Z(bDateAt)
//line app/qtpl/CellView.qtpl:42
	qw422016.N().S(`</p>
    <p class="author">`)
//line app/qtpl/CellView.qtpl:43
	qw422016.E().S(nick)
//line app/qtpl/CellView.qtpl:43
	qw422016.N().S(`</p>
  </footer>
</div>
<script>
document.title="`)
//line app/qtpl/CellView.qtpl:47
	qw422016.E().S(content.Title)
//line app/qtpl/CellView.qtpl:47
	qw422016.N().S(`";let _nick="`)
//line app/qtpl/CellView.qtpl:47
	qw422016.E().S(nick)
//line app/qtpl/CellView.qtpl:47
	qw422016.N().S(`";
let ca = document.cookie.split(";"), str;
for(let i=0;i < ca.length;i++) {
	str = ca[i].trim();
	if(str.substr(0,5)=='_nick' && str.split('=')[1]==_nick){
		let t = document.getElementById("txtTitle");
		t.className=""
		t.href = "/cell/edit/" + `)
//line app/qtpl/CellView.qtpl:54
	qw422016.N().D(iid)
//line app/qtpl/CellView.qtpl:54
	qw422016.N().S(`;
		break;
	}
}

let __imgs = document.querySelectorAll('#articleMain img');
for (let i=0;i<__imgs.length;i++) {
	if(!__imgs[i].alt) continue;
	let span=document.createElement("span");
	span.className = 'img-desc';
	span.innerText = '-- ' + __imgs[i].alt + ' --';
	__imgs[i].parentNode.insertBefore(span, __imgs[i].nextSibling);
}
</script>
`)
//line app/qtpl/CellView.qtpl:68
}

//line app/qtpl/CellView.qtpl:68
func WriteCellView(qq422016 qtio422016.Writer, row db.MapRow, ojson *selem.OJSON) {
//line app/qtpl/CellView.qtpl:68
	qw422016 := qt422016.AcquireWriter(qq422016)
//line app/qtpl/CellView.qtpl:68
	StreamCellView(qw422016, row, ojson)
//line app/qtpl/CellView.qtpl:68
	qt422016.ReleaseWriter(qw422016)
//line app/qtpl/CellView.qtpl:68
}

//line app/qtpl/CellView.qtpl:68
func CellView(row db.MapRow, ojson *selem.OJSON) string {
//line app/qtpl/CellView.qtpl:68
	qb422016 := qt422016.AcquireByteBuffer()
//line app/qtpl/CellView.qtpl:68
	WriteCellView(qb422016, row, ojson)
//line app/qtpl/CellView.qtpl:68
	qs422016 := string(qb422016.B)
//line app/qtpl/CellView.qtpl:68
	qt422016.ReleaseByteBuffer(qb422016)
//line app/qtpl/CellView.qtpl:68
	return qs422016
//line app/qtpl/CellView.qtpl:68
}

//line app/qtpl/CellView.qtpl:71
func StreamAreasTags(qw422016 *qt422016.Writer, areas []baseinfo.Area, tags []string) {
//line app/qtpl/CellView.qtpl:71
	qw422016.N().S(`
	<div class="areas-tags m-b-md">
	`)
//line app/qtpl/CellView.qtpl:73
	for _, a := range areas {
//line app/qtpl/CellView.qtpl:73
		qw422016.N().S(`
		<strong><a href="/area/`)
//line app/qtpl/CellView.qtpl:74
		qw422016.E().S(a.CN)
//line app/qtpl/CellView.qtpl:74
		qw422016.N().S(`">`)
//line app/qtpl/CellView.qtpl:74
		qw422016.E().S(a.CN)
//line app/qtpl/CellView.qtpl:74
		qw422016.N().S(`</a></strong>
	`)
//line app/qtpl/CellView.qtpl:75
	}
//line app/qtpl/CellView.qtpl:75
	qw422016.N().S(`
	`)
//line app/qtpl/CellView.qtpl:76
	for _, name := range tags {
//line app/qtpl/CellView.qtpl:76
		qw422016.N().S(`
		<strong><a href="/tag/`)
//line app/qtpl/CellView.qtpl:77
		qw422016.E().S(name)
//line app/qtpl/CellView.qtpl:77
		qw422016.N().S(`">`)
//line app/qtpl/CellView.qtpl:77
		qw422016.E().S(name)
//line app/qtpl/CellView.qtpl:77
		qw422016.N().S(`</a></strong>
	`)
//line app/qtpl/CellView.qtpl:78
	}
//line app/qtpl/CellView.qtpl:78
	qw422016.N().S(`
	</div>
`)
//line app/qtpl/CellView.qtpl:80
}

//line app/qtpl/CellView.qtpl:80
func WriteAreasTags(qq422016 qtio422016.Writer, areas []baseinfo.Area, tags []string) {
//line app/qtpl/CellView.qtpl:80
	qw422016 := qt422016.AcquireWriter(qq422016)
//line app/qtpl/CellView.qtpl:80
	StreamAreasTags(qw422016, areas, tags)
//line app/qtpl/CellView.qtpl:80
	qt422016.ReleaseWriter(qw422016)
//line app/qtpl/CellView.qtpl:80
}

//line app/qtpl/CellView.qtpl:80
func AreasTags(areas []baseinfo.Area, tags []string) string {
//line app/qtpl/CellView.qtpl:80
	qb422016 := qt422016.AcquireByteBuffer()
//line app/qtpl/CellView.qtpl:80
	WriteAreasTags(qb422016, areas, tags)
//line app/qtpl/CellView.qtpl:80
	qs422016 := string(qb422016.B)
//line app/qtpl/CellView.qtpl:80
	qt422016.ReleaseByteBuffer(qb422016)
//line app/qtpl/CellView.qtpl:80
	return qs422016
//line app/qtpl/CellView.qtpl:80
}

//line app/qtpl/CellView.qtpl:82
func StreamSubforms(qw422016 *qt422016.Writer, subforms []selem.SubForm) {
//line app/qtpl/CellView.qtpl:82
	qw422016.N().S(`
<div class="subforms m-b-md">
	`)
//line app/qtpl/CellView.qtpl:85
	l := len(subforms)
	if l == 0 {
		return
	}

//line app/qtpl/CellView.qtpl:89
	qw422016.N().S(`
	<ul class="data-list m-b">
		`)
//line app/qtpl/CellView.qtpl:91
	for i := 0; i < l; i++ {
//line app/qtpl/CellView.qtpl:91
		qw422016.N().S(`
			`)
//line app/qtpl/CellView.qtpl:93
		title := subforms[i].Title
		dateON := subforms[i].DateON
		if len(dateON) > 10 {
			dateON = dateON[:10]
		}
		items := subforms[i].Items
		n := len(items)

//line app/qtpl/CellView.qtpl:100
		qw422016.N().S(`
			`)
//line app/qtpl/CellView.qtpl:101
		if title != "" || dateON != "" {
//line app/qtpl/CellView.qtpl:101
			qw422016.N().S(`
				<li>
					`)
//line app/qtpl/CellView.qtpl:103
			if title != "" {
//line app/qtpl/CellView.qtpl:103
				qw422016.N().S(`
						<strong class="m-r">`)
//line app/qtpl/CellView.qtpl:104
				qw422016.E().S(title)
//line app/qtpl/CellView.qtpl:104
				qw422016.N().S(`</strong>
					`)
//line app/qtpl/CellView.qtpl:105
			}
//line app/qtpl/CellView.qtpl:105
			qw422016.N().S(`
					`)
//line app/qtpl/CellView.qtpl:106
			if dateON != "" {
//line app/qtpl/CellView.qtpl:106
				qw422016.N().S(`
						<strong>`)
//line app/qtpl/CellView.qtpl:107
				qw422016.E().S(dateON)
//line app/qtpl/CellView.qtpl:107
				qw422016.N().S(`</strong>
					`)
//line app/qtpl/CellView.qtpl:108
			}
//line app/qtpl/CellView.qtpl:108
			qw422016.N().S(`
				</li>
			`)
//line app/qtpl/CellView.qtpl:110
		}
//line app/qtpl/CellView.qtpl:110
		qw422016.N().S(`
			`)
//line app/qtpl/CellView.qtpl:111
		for k := 0; k < n; k++ {
//line app/qtpl/CellView.qtpl:111
			qw422016.N().S(`
				`)
//line app/qtpl/CellView.qtpl:113
			match := linkReg.FindAllSubmatch(util.Str2Bytes(items[k].Value), -1)

//line app/qtpl/CellView.qtpl:114
			qw422016.N().S(`
				<li>
					<span class="label">`)
//line app/qtpl/CellView.qtpl:116
			qw422016.E().S(items[k].Key)
//line app/qtpl/CellView.qtpl:116
			qw422016.N().S(`ï¼š</span>
					`)
//line app/qtpl/CellView.qtpl:117
			if len(match) > 0 && len(match[0]) == 3 {
//line app/qtpl/CellView.qtpl:117
				qw422016.N().S(`
						`)
//line app/qtpl/CellView.qtpl:119
				bname := bytes.TrimSpace(match[0][1])

//line app/qtpl/CellView.qtpl:120
				qw422016.N().S(`
						<a href="`)
//line app/qtpl/CellView.qtpl:121
				qw422016.E().Z(match[0][2])
//line app/qtpl/CellView.qtpl:121
				qw422016.N().S(`">
						`)
//line app/qtpl/CellView.qtpl:122
				if len(bname) == 0 {
//line app/qtpl/CellView.qtpl:122
					qw422016.N().S(`
							`)
//line app/qtpl/CellView.qtpl:123
					qw422016.E().Z(match[0][2])
//line app/qtpl/CellView.qtpl:123
					qw422016.N().S(`
						`)
//line app/qtpl/CellView.qtpl:124
				} else {
//line app/qtpl/CellView.qtpl:124
					qw422016.N().S(`
							`)
//line app/qtpl/CellView.qtpl:125
					qw422016.E().Z(match[0][1])
//line app/qtpl/CellView.qtpl:125
					qw422016.N().S(`
						`)
//line app/qtpl/CellView.qtpl:126
				}
//line app/qtpl/CellView.qtpl:126
				qw422016.N().S(`
						</a>
					`)
//line app/qtpl/CellView.qtpl:128
			} else {
//line app/qtpl/CellView.qtpl:128
				qw422016.N().S(`
						<span>`)
//line app/qtpl/CellView.qtpl:129
				qw422016.E().S(items[k].Value)
//line app/qtpl/CellView.qtpl:129
				qw422016.N().S(`</span>
					`)
//line app/qtpl/CellView.qtpl:130
			}
//line app/qtpl/CellView.qtpl:130
			qw422016.N().S(`
				</li>
			`)
//line app/qtpl/CellView.qtpl:132
		}
//line app/qtpl/CellView.qtpl:132
		qw422016.N().S(`
		`)
//line app/qtpl/CellView.qtpl:133
	}
//line app/qtpl/CellView.qtpl:133
	qw422016.N().S(`
	</ul>
</div>
`)
//line app/qtpl/CellView.qtpl:136
}

//line app/qtpl/CellView.qtpl:136
func WriteSubforms(qq422016 qtio422016.Writer, subforms []selem.SubForm) {
//line app/qtpl/CellView.qtpl:136
	qw422016 := qt422016.AcquireWriter(qq422016)
//line app/qtpl/CellView.qtpl:136
	StreamSubforms(qw422016, subforms)
//line app/qtpl/CellView.qtpl:136
	qt422016.ReleaseWriter(qw422016)
//line app/qtpl/CellView.qtpl:136
}

//line app/qtpl/CellView.qtpl:136
func Subforms(subforms []selem.SubForm) string {
//line app/qtpl/CellView.qtpl:136
	qb422016 := qt422016.AcquireByteBuffer()
//line app/qtpl/CellView.qtpl:136
	WriteSubforms(qb422016, subforms)
//line app/qtpl/CellView.qtpl:136
	qs422016 := string(qb422016.B)
//line app/qtpl/CellView.qtpl:136
	qt422016.ReleaseByteBuffer(qb422016)
//line app/qtpl/CellView.qtpl:136
	return qs422016
//line app/qtpl/CellView.qtpl:136
}
